//
// Copyright 2020 IBM Corporation
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

package yaml

import (
	"testing"
)

const testMessage = "YXBpVmVyc2lvbjogdjEKa2luZDogU2VydmljZQptZXRhZGF0YToKICBuYW1lOiB0ZXN0LW11bHRpMi1zZXJ2aWNlCnNwZWM6CiAgdHlwZTogTG9hZEJhbGFuY2VyCiAgc2VsZWN0b3I6CiAgICBhcHA6IGhpcm8tdGVzdC1hcHAKICBwb3J0czoKICAtIHByb3RvY29sOiBUQ1AKICAgIHBvcnQ6IDgwCiAgICB0YXJnZXRQb3J0OiA5Mzc2Ci0tLQphcGlWZXJzaW9uOiB2MQpraW5kOiBDb25maWdNYXAKbWV0YWRhdGE6CiAgbmFtZTogc2FtcGxlLWNtCmRhdGE6CiAga2V5MTogdmFsMQogIGtleTI6IHZhbDIK"
const testMessage2 = "YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtbmFtZXNwYWNlCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBlbmZvcmNlCiAgICAgICAgICBzZXZlcml0eTogSGlnaAogICAgICAgICAgb2JqZWN0LXRlbXBsYXRlczoKICAgICAgICAgICAgLSBjb21wbGlhbmNlVHlwZTogbXVzdGhhdmUKICAgICAgICAgICAgICBvYmplY3REZWZpbml0aW9uOgogICAgICAgICAgICAgICAga2luZDogTmFtZXNwYWNlCiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiB2MQogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtb2cKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MQogICAgICAgICAgICAgICAga2luZDogT3BlcmF0b3JHcm91cAogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1vcGVyYXRvci1ncm91cAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VzOgogICAgICAgICAgICAgICAgICAgIC0gaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1jYXRyc2MKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogQ2F0YWxvZ1NvdXJjZQogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3ItY2F0YWxvZwogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1tYXJrZXRwbGFjZQogICAgICAgICAgICAgICAgc3BlYzoKICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IEludGVncml0eSBTaGllbGQgT3BlcmF0b3IKICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1pbmRleDowLjEuMgogICAgICAgICAgICAgICAgICBwdWJsaXNoZXI6IElCTQogICAgICAgICAgICAgICAgICBzb3VyY2VUeXBlOiBncnBjCiAgICAgICAgICAgICAgICAgIHVwZGF0ZVN0cmF0ZWd5OgogICAgICAgICAgICAgICAgICAgIHJlZ2lzdHJ5UG9sbDoKICAgICAgICAgICAgICAgICAgICAgIGludGVydmFsOiA0NW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1zdWIKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU3Vic2NyaXB0aW9uCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBjaGFubmVsOiBhbHBoYQogICAgICAgICAgICAgICAgICBpbnN0YWxsUGxhbkFwcHJvdmFsOiBBdXRvbWF0aWMKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBzb3VyY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3ItY2F0YWxvZwogICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lc3BhY2U6IG9wZW5zaGlmdC1tYXJrZXRwbGFjZQogICAgICAgICAgICAgICAgICBzdGFydGluZ0NTVjogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci52MC4xLjIKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1jcgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGFwaXMuaW50ZWdyaXR5c2hpZWxkLmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBJbnRlZ3JpdHlTaGllbGQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLXNlcnZlcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBpbWFnZVB1bGxTZWNyZXRzOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogbWFwcHJlZ2tleQogICAgICAgICAgICAgICAgICBsb2dnZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHVzLmljci5pby9tdXRhdGlvbi1hZHZpc29yL2ludGVncml0eS1zaGllbGQtbG9nZ2luZzowLjEuM2RldgogICAgICAgICAgICAgICAgICBzZXJ2ZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHVzLmljci5pby9tdXRhdGlvbi1hZHZpc29yL2ludGVncml0eS1zaGllbGQtc2VydmVyOjAuMS4zZGV2CiAgICAgICAgICAgICAgICAgIGFmZmluaXR5OiB7fQogICAgICAgICAgICAgICAgICBzaGllbGRDb25maWc6CiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5VHlwZTogcGdwICMgeDUwOQogICAgICAgICAgICAgICAgICAgIGlTaGllbGRBZG1pblVzZXJOYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50LWFkZG9uOmtsdXN0ZXJsZXQtYWRkb24tcG9saWN5Y3RybCIKICAgICAgICAgICAgICAgICAgICBpblNjb3BlTmFtZXNwYWNlU2VsZWN0b3I6CiAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlOgogICAgICAgICAgICAgICAgICAgICAgICAtICIqIgogICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZToKICAgICAgICAgICAgICAgICAgICAgICAgLSAia3ViZS0qIgogICAgICAgICAgICAgICAgICAgICAgICAtICJvcGVuc2hpZnQtKiIKICAgICAgICAgICAgICAgICAgc2lnbmVyQ29uZmlnOgogICAgICAgICAgICAgICAgICAgIHBvbGljaWVzOgogICAgICAgICAgICAgICAgICAgICAgLSBuYW1lc3BhY2VzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIioiCiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lcnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSAiU2FtcGxlU2lnbmVyIgogICAgICAgICAgICAgICAgICAgICAgLSBzY29wZTogIkNsdXN0ZXIiCiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lcnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSAiU2FtcGxlU2lnbmVyIgogICAgICAgICAgICAgICAgICAgIHNpZ25lcnM6CiAgICAgICAgICAgICAgICAgICAgICAtIG5hbWU6ICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgICAgIGtleUNvbmZpZzogc2FtcGxlLXNpZ25lci1rZXljb25maWcKICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdHM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSBlbWFpbDogInNpZ25lckBlbnRlcnByaXNlLmNvbSIKICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogc2FtcGxlLXNpZ25lci1rZXljb25maWcKICAgICAgICAgICAgICAgICAgICAgIHNlY3JldE5hbWU6IGtleXJpbmctc2VjcmV0CiAgICAgICAgICAgICAgICAgIHJlc291cmNlU2lnbmluZ1Byb2ZpbGVzOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogcG9saWN5LXJzcAogICAgICAgICAgICAgICAgICAgICAgcHJvdGVjdFJ1bGVzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQ6KiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246KiIKICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ2hlY2tSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgIGt1c3RvbWl6ZVBhdHRlcm5zOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IFBvbGljeQogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQcmVmaXg6ICIqLiIKICAgICAgICAgICAgICAgICAgICAgIHVucHJvdGVjdEF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1kZXBsb3lhYmxlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1zdWJzY3JpcHRpb25cIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmFubm90YXRpb25zLlwiYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zeW5jLXNvdXJjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZXNwYWNlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5sYWJlbHMuXCJwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vcm9vdC1wb2xpY3lcIiIKICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGtleTogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2lzQ2x1c3Rlck5hbWVzcGFjZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogSW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbInRydWUiXQotLS0KYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBsYWNlbWVudEJpbmRpbmcKbWV0YWRhdGE6CiAgbmFtZTogYmluZGluZy1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpwbGFjZW1lbnRSZWY6CiAgbmFtZTogcGxhY2VtZW50LXBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQKICAgIGtpbmQ6IFBvbGljeQogICAgYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwotLS0KYXBpVmVyc2lvbjogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRSdWxlCm1ldGFkYXRhOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpzcGVjOgogIGNsdXN0ZXJDb25kaXRpb25zOgogICAgLSBzdGF0dXM6ICJUcnVlIgogICAgICB0eXBlOiBNYW5hZ2VkQ2x1c3RlckNvbmRpdGlvbkF2YWlsYWJsZQogIGNsdXN0ZXJTZWxlY3RvcjoKICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgIC0ge2tleTogZW52aXJvbm1lbnQsIG9wZXJhdG9yOiBJbiwgdmFsdWVzOiBbImRldiJdfQo="

func TestFindSingleYaml(t *testing.T) {
	ok, _ := FindSingleYaml([]byte(testMessage), "v1", "ConfigMap", "sample-cm", "secure-ns")
	if !ok {
		t.Error("Failed to test1 in TestFindSingleYaml()")
	}
	ok2, _ := FindSingleYaml([]byte(testMessage2), "policy.open-cluster-management.io/v1", "Policy", "policy-integrity-shield", "ma4dev7")
	if !ok2 {
		t.Error("Failed to test2 in TestFindSingleYaml()")
	}
}
